---
name: user-model-evolve
description: 会話から学習し、user_model.yaml の更新を提案する。自己進化のコア機能。セッション終了時や「進化して」「学習して」で発火。
---

# Evolve Skill 🧬

会話の内容から学習し、User Model の更新を自律的に提案します。

> **設定**: パスは `user-model-core/config.yaml` を参照

## 自己進化のトリガー

### 明示的トリガー
- 「進化して」「学習して」「更新を提案して」

### 暗黙的トリガー（検知して提案）
- ユーザーが好み・価値観を明示した
- 特定のアプローチが効果的だった
- ユーザーが繰り返し修正を求めたパターン
- セッションが長く続いた後

## 進化の観点

### 1. stable への追加候補

| 検知パターン | 提案 |
|-------------|------|
| 「〇〇は絶対嫌」 | `anti_goals` に追加 |
| 「〇〇が大事」 | `values` に追加 |
| 「〇〇形式で」（繰り返し） | `formatting.prefer` に追加 |
| 「〇〇は避けて」（繰り返し） | `formatting.avoid` に追加 |

### 2. learning_log への追加候補

| 検知パターン | 提案 |
|-------------|------|
| 「これいい」「効いた」 | `corrections_that_worked` に追加 |
| 同じミスを指摘された | `common_pitfalls` に追加 |

### 3. mutable の更新候補

| 検知パターン | 提案 |
|-------------|------|
| 新しいプロジェクトの話題 | `current_projects` に追加 |
| 「今は〇〇に集中」 | `current_focus_topics` を更新 |

## 出力フォーマット

```
🧬 進化の提案

今回の会話から以下の学習を検知しました：

【stable への追加】
A. formatting.prefer に「選択肢は記号で」を追加
   理由: 明示的に要望があった

【learning_log への追加】
B. corrections_that_worked に記録
   - context: "選択肢の提示"
   - intervention: "記号で一発選択"
   - outcome: "効率化"

【mutable の更新】
C. current_projects に「User Model 構築」を追加

適用: [A] [B] [C] [全部] [なし]
```

## 進化のルール

1. **確認必須**: 自動更新はしない。必ず提案→承認
2. **根拠提示**: なぜその学習をしたか説明
3. **可逆性**: 間違った学習は `forget` で削除可能
4. **段階的**: 一度に大量の変更を提案しない

## confidence スコア

| スコア | 基準 |
|--------|------|
| 0.9+ | ユーザーが明示的に言った |
| 0.7-0.8 | 繰り返しパターンから推測 |
| 0.5-0.6 | 単発の反応から推測 |
| 0.5未満 | 提案しない |

## メタ学習

`evolve` 自体の効果も記録する：
- 提案が採用された → confidence 上げる
- 提案が却下された → パターンを見直す
